version: 2.1
jobs:
  build:
    docker:
      - image: circleci/python:3.7.2
    working_directory: ~/docker_django_sns/myproject
    steps:
      - checkout
      - setup_remote_docker:
          version: 19.03.13
      - run:
          name: Dockerコンテナのビルド
          command: docker-compose -f myproject/docker-compose.yml build
      - run:
          name: django,test_views.py実行
          command: docker-compose -f myproject/docker-compose.yml run web python3 manage.py test
      - run:
          name: Dockerコンテナの起動
          command: docker-compose -f myproject/docker-compose.yml up
      - run:
          name: Dockerコンテナの停止
          command: docker-compose -f myproject/docker-compose.yml down